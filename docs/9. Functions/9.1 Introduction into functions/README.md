# Введение в функции

- Функций — объект БД, принимающий аргументы и возвращающий результат
- Что если есть клиентский код, опрашивающий БД?
- Функции (хранимые процедуры) - компилируемы и хранятся на стороне БД. А потому их вызов стоит дёшево
- Разграничение работы Frontend-dev и Server-side dev
- Хранить код, который работает с кортежами логичнее ближе к данным (SRP)
- Переиспользуемость функций разными клиентскими приложениями
- Управление безопасностью через регулирование доступа к функциям
- Уменьшение трафика на сеть
- Модульное программирование. Что если нужна генерация случайных чисел от 1 до 10 в разных SQL-скриптах

### Функции в Postgres

- Состоят из набора утверждений, возвращая результат последнего
- Могут содержать `SELECT`, `INSERT`, `UPDATE`, `DELETE` (CRUD)
- Не могут содержать `COMMIT`, `SAVEPOINT (TCL)`, `VACUUM (utility)`

Делятся на:
- SQL-функции
- Процедурные (PL/pgSQL - основной диалект)
- Серверные функции (написанные на С)
- Собственные С-функции

### Синтаксис

```sql
CREATE FUNCTION func_name([arg1, arg2...]) RETURNS data_type AS $$
-- logic
$$ LANGUAGE lang
```

***Вместо $$ до 8-й версии использовали кавычки***

```sql
CREATE OR REPLACE func_name... -- модифицирует уже существующую функцию с таким именем
```
